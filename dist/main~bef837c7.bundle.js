/*! For license information please see main~bef837c7.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e={358:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function i(){i=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function h(e,r,n,i){var a=r&&r.prototype instanceof f?r:f,o=Object.create(a.prototype);return l(o,"_invoke",function(e,r,n){var i=1;return function(a,o){if(3===i)throw Error("Generator is already running");if(4===i){if("throw"===a)throw o;return{value:t,done:!0}}for(n.method=a,n.arg=o;;){var s=n.delegate;if(s){var u=E(s,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===i)throw i=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=3;var c=p(e,r,n);if("normal"===c.type){if(i=n.done?4:2,c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=4,n.method="throw",n.arg=c.arg)}}}(e,n,new x(i||[])),!0),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d={};function f(){}function v(){}function m(){}var y={};l(y,s,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(I([])));b&&b!==r&&a.call(b,s)&&(y=b);var k=m.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(i,o,s,u){var c=p(t[i],t,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==n(h)&&a.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,u)}),(function(t){r("throw",t,s,u)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,u)}))}u(c.arg)}var i;l(this,"_invoke",(function(t,n){function a(){return new e((function(e,i){r(t,n,e,i)}))}return i=i?i.then(a,a):a()}),!0)}function E(e,r){var n=r.method,i=e.i[n];if(i===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=p(i,e.i,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var o=a.arg;return o?o.done?(r[e.r]=o.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function M(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function x(t){this.tryEntries=[[-1]],t.forEach(M,this),this.reset(!0)}function I(e){if(null!=e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(a.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(n(e)+" is not iterable")}return v.prototype=m,l(k,"constructor",m),l(m,"constructor",v),v.displayName=l(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},w(L.prototype),l(L.prototype,u,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var o=new L(h(t,r,n,i),a);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},w(k),l(k,c,"Generator"),l(k,s,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=I,x.prototype={constructor:x,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){o.type="throw",o.arg=e,r.next=t}for(var i=r.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a[4],s=this.prev,u=a[1],c=a[2];if(-1===a[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var i=n;break}}i&&("break"===t||"continue"===t)&&i[0]<=e&&e<=i[2]&&(i=null);var a=i?i[4]:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i[2],d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var i=n.arg;S(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:I(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function a(t,e,r,n,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,i)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function s(t){a(o,n,i,s,u,"next",t)}function u(t){a(o,n,i,s,u,"throw",t)}s(void 0)}))}}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}r.d(e,{A:()=>c});const c=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storyList=document.getElementById("story-list"),this.storyForm=document.getElementById("story-form"),this.loginForm=document.getElementById("login-form"),this.registerForm=document.getElementById("register-form"),this.camera=document.getElementById("camera"),this.canvas=document.getElementById("canvas"),this.captureBtn=document.getElementById("capture"),this.mapContainer=document.getElementById("map"),this.storyMapContainer=document.getElementById("story-map"),this.pages=document.querySelectorAll(".page"),this.photoInput=document.getElementById("photo"),this.photoPreview=document.getElementById("preview"),this.navList=document.getElementById("nav-list"),this.navLinks=document.querySelectorAll("nav a"),this.map=null,this.storyMap=null,this.currentMarker=null,this.storyMarkers=[],this.stream=null,this.capturedImageData=null,this.onRegisterSubmit=null,this.onLoginSubmit=null,this.onStorySubmit=null,this.onCaptureClick=null,this.onNavLinkClick=null,this.onMapClick=null,this.onFavoriteClick=null,this._initializeEventListeners()},e=[{key:"_initializeEventListeners",value:function(){this._setupSkipToContent(),this._setupPhotoInput(),this._setupFormEventListeners(),this._setupNavigationEventListeners(),this._setupPasswordToggle()}},{key:"_setupSkipToContent",value:function(){var t=document.querySelector("#main-content"),e=document.querySelector(".skip-to-content");e&&t&&e.addEventListener("click",(function(r){r.preventDefault(),e.blur(),t.focus(),t.scrollIntoView()}))}},{key:"_setupPhotoInput",value:function(){var t=this;this.photoInput.addEventListener("change",(function(e){var r=e.target.files[0];if(r&&r.type.startsWith("image/")){if(r.size>1048576)return t.showMessage("Ukuran foto terlalu besar. Maksimal 1MB.",!0),void(t.photoInput.value="");t._previewImageFile(r)}else t.showMessage("Harap pilih file gambar yang valid.",!0),t.photoInput.value=""}))}},{key:"_previewImageFile",value:function(t){var e=this,r=new FileReader;r.onload=function(t){e.photoPreview.src=t.target.result,e.photoPreview.classList.remove("hidden"),e.capturedImageData=null},r.readAsDataURL(t)}},{key:"_setupFormEventListeners",value:function(){var t=this;this.registerForm.addEventListener("submit",(function(e){if(e.preventDefault(),t.onRegisterSubmit){var r=new FormData(e.target),n={name:r.get("name"),email:r.get("email"),password:r.get("password")};t.onRegisterSubmit(n)}})),this.loginForm.addEventListener("submit",(function(e){if(e.preventDefault(),t.onLoginSubmit){var r=new FormData(e.target),n={email:r.get("email"),password:r.get("password")};t.onLoginSubmit(n)}})),this.storyForm.addEventListener("submit",(function(e){if(e.preventDefault(),t.onStorySubmit){var r={description:e.target.description.value.trim(),photoFile:t.getPhotoFromInput(),imageData:t.capturedImageData};t.onStorySubmit(r)}})),this.captureBtn.addEventListener("click",(function(){t.onCaptureClick&&t.onCaptureClick()}))}},{key:"_setupNavigationEventListeners",value:function(){var t=this;this.navLinks.forEach((function(e){e.addEventListener("click",(function(r){if(t.onNavLinkClick){var n=e.getAttribute("href").substring(1);t.onNavLinkClick(r,n)}}))}))}},{key:"_setupPasswordToggle",value:function(){document.querySelectorAll(".toggle-password").forEach((function(t){t.addEventListener("click",(function(){var e=t.getAttribute("data-target"),r=document.getElementById(e);"password"===r.type?(r.type="text",t.classList.remove("fa-eye"),t.classList.add("fa-eye-slash")):(r.type="password",t.classList.remove("fa-eye-slash"),t.classList.add("fa-eye"))}))}))}},{key:"updateNav",value:function(t){var e=this.navList.querySelector(".login-nav"),r=this.navList.querySelector(".register-nav"),n=this.navList.querySelector(".logout-nav");t?(e.classList.add("hidden"),r.classList.add("hidden"),n.classList.remove("hidden")):(e.classList.remove("hidden"),r.classList.remove("hidden"),n.classList.add("hidden"))}},{key:"displayStories",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.storyList.innerHTML="",this.clearStoryMapMarkers(),t.forEach((function(t){var n,i,a=document.createElement("div");a.className="story-card",a.setAttribute("role","listitem");var o=r.some((function(e){return e.id===t.id}));if(a.innerHTML='\n        <img src="'.concat(t.photoUrl,'" alt="Foto cerita ').concat(t.name,'" loading="lazy">\n        <h3>').concat(t.name,"</h3>\n        <p>").concat(t.description,"</p>\n        <p>Lokasi: ").concat(null!==(n=t.lat)&&void 0!==n?n:"-",", ").concat(null!==(i=t.lon)&&void 0!==i?i:"-","</p>\n        <p>Dibuat: ").concat(new Date(t.createdAt).toLocaleDateString("id-ID"),'</p>\n        <button class="favorite-btn ').concat(o?"favorited":"",'"\n                 data-story-id="').concat(t.id,'"\n                 aria-label="').concat(o?"Hapus dari favorit":"Tambah ke favorit",'"\n                 aria-pressed="').concat(o,'">\n            <i class="fas fa-heart"></i> ').concat(o?"Hapus Favorit":"Tambah Favorit","\n        </button>\n      "),e.storyList.appendChild(a),t.lat&&t.lon&&e.storyMap){var s=L.marker([t.lat,t.lon]).addTo(e.storyMap);s.bindPopup("\n          <b>".concat(t.name,"</b><br>\n          ").concat(t.description,'<br>\n          <img src="').concat(t.photoUrl,'" alt="Foto cerita ').concat(t.name,'" style="max-width: 100px;">\n        ')),e.storyMarkers.push(s)}})),this.storyList.querySelectorAll(".favorite-btn").forEach((function(r){r.addEventListener("click",(function(n){n.preventDefault();var i=r.getAttribute("data-story-id"),a=t.find((function(t){return t.id===i})),o=!r.classList.contains("favorited");e.onFavoriteClick&&a&&e.onFavoriteClick(a,o)}))}))}},{key:"updateFavoriteButton",value:function(t,e){var r=this.storyList.querySelector('[data-story-id="'.concat(t,'"]'));r&&(e?(r.classList.add("favorited"),r.innerHTML='<i class="fas fa-heart"></i> Hapus Favorit',r.setAttribute("aria-label","Hapus dari favorit"),r.setAttribute("aria-pressed","true")):(r.classList.remove("favorited"),r.innerHTML='<i class="fas fa-heart"></i> Tambah Favorit',r.setAttribute("aria-label","Tambah ke favorit"),r.setAttribute("aria-pressed","false")))}},{key:"displayFavoriteStories",value:function(t){this.storyList.innerHTML="",this.clearStoryMapMarkers(),0!==t.length?this.displayStories(t,t):this.storyList.innerHTML='<p class="no-favorites">Belum ada cerita favorit.</p>'}},{key:"setupCamera",value:(r=o(i().mark((function t(){var e;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({video:!0});case 3:return e=t.sent,this.camera.srcObject=e,this.stream=e,t.abrupt("return",e);case 9:throw t.prev=9,t.t0=t.catch(0),new Error("Tidak dapat mengakses kamera: "+t.t0.message);case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return r.apply(this,arguments)})},{key:"stopCamera",value:function(){this.stream&&(this.stream.getTracks().forEach((function(t){return t.stop()})),this.stream=null,this.camera.srcObject=null)}},{key:"captureImage",value:function(){if(!this.stream)return null;var t=this.canvas.getContext("2d");return this.canvas.width=this.camera.videoWidth,this.canvas.height=this.camera.videoHeight,t.drawImage(this.camera,0,0),this.capturedImageData=this.canvas.toDataURL("image/jpeg"),this.capturedImageData}},{key:"showImagePreview",value:function(t){this.photoPreview.src=t,this.photoPreview.classList.remove("hidden"),this.photoInput.value=""}},{key:"setupMap",value:function(){var t=this;if(this.map)return this.map;this.mapContainer.setAttribute("aria-label","Peta interaktif untuk memilih lokasi cerita"),this.map=L.map(this.mapContainer).setView([-6.185931,106.552764],17);var e=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}),r=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:"© CartoDB"}),n=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"© Esri"}),i=L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{attribution:"© OpenTopoMap contributors"});e.addTo(this.map);var a={OpenStreetMap:e,"CartoDB Light":r,Satellite:n,Topographic:i};return L.control.layers(a).addTo(this.map),this.map.on("click",(function(e){t.onMapClick&&t.onMapClick(e.latlng)})),this.map}},{key:"setupStoryMap",value:function(){if(this.storyMap)return this.storyMap;this.storyMapContainer.setAttribute("aria-label","Peta interaktif untuk menampilkan lokasi cerita"),this.storyMap=L.map(this.storyMapContainer).setView([-6.185931,106.552764],10);var t=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}),e=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:"© CartoDB"}),r=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"© Esri"}),n=L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{attribution:"© OpenTopoMap contributors"});t.addTo(this.storyMap);var i={OpenStreetMap:t,"CartoDB Light":e,Satellite:r,Topographic:n};return L.control.layers(i).addTo(this.storyMap),this.storyMap}},{key:"updateMapMarker",value:function(t){this.map&&(this.currentMarker&&this.map.removeLayer(this.currentMarker),this.currentMarker=L.marker([t.lat,t.lng]).addTo(this.map),this.currentMarker.bindPopup("Lokasi Cerita").openPopup())}},{key:"clearMapMarkers",value:function(){this.map&&this.currentMarker&&(this.map.removeLayer(this.currentMarker),this.currentMarker=null)}},{key:"clearStoryMapMarkers",value:function(){var t=this;this.storyMap&&this.storyMarkers.length>0&&(this.storyMarkers.forEach((function(e){return t.storyMap.removeLayer(e)})),this.storyMarkers=[])}},{key:"showPage",value:function(t){this.pages.forEach((function(e){e.classList.toggle("hidden",e.id!==t)}))}},{key:"showMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Swal.fire({title:e?"Error!":"Success!",text:t,icon:e?"error":"success",confirmButtonColor:"#3B82F6",timer:e?void 0:2e3,showConfirmButton:e})}},{key:"resetStoryForm",value:function(){this.storyForm.reset(),this.photoPreview.classList.add("hidden"),this.photoPreview.src="",this.photoInput.value="",this.capturedImageData=null}},{key:"getPhotoFromInput",value:function(){return this.photoInput.files.length>0?this.photoInput.files[0]:null}},{key:"navigateTo",value:function(t){window.location.hash=t}},{key:"getCurrentHash",value:function(){return window.location.hash.slice(1)||"login"}},{key:"handlePageViewTransition",value:function(t,e){var r=this;document.startViewTransition?document.startViewTransition(o(i().mark((function n(){var a,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=document.querySelector(".page:not(.hidden)"),o=document.getElementById(t),!a){n.next=6;break}return a.style.animation="fadeOut 0.3s ease-out forwards",n.next=6,new Promise((function(t){return setTimeout(t,300)}));case 6:if(r.showPage(t),o&&(o.style.animation="fadeIn 0.5s ease-in forwards"),!e){n.next=11;break}return n.next=11,e();case 11:case"end":return n.stop()}}),n)})))):(this.showPage(t),e&&e())}},{key:"setupNotificationButton",value:function(t){var e=document.querySelector("#notification-button");e||((e=document.createElement("button")).id="notification-button",e.textContent="Aktifkan Notifikasi",e.className="btn-secondary",e.style.cssText="\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        z-index: 1000;\n        padding: 10px 15px;\n        background: #3B82F6;\n        color: white;\n        border: none;\n        border-radius: 5px;\n        cursor: pointer;\n      ",document.body.appendChild(e)),e.addEventListener("click",t)}},{key:"updateNotificationUI",value:function(t){var e=document.querySelector("#notification-button");e&&(t?(e.textContent="Notifikasi Aktif",e.style.background="#10B981",e.disabled=!0):(e.textContent="Aktifkan Notifikasi",e.style.background="#3B82F6",e.disabled=!1))}}],e&&s(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()}},r={};function n(t){var i=r[t];if(void 0!==i)return i.exports;var a=r[t]={id:t,exports:{}};return e[t](a,a.exports,n),a.exports}n.m=e,t=[],n.O=(e,r,i,a)=>{if(!r){var o=1/0;for(l=0;l<t.length;l++){for(var[r,i,a]=t[l],s=!0,u=0;u<r.length;u++)(!1&a||o>=a)&&Object.keys(n.O).every((t=>n.O[t](r[u])))?r.splice(u--,1):(s=!1,a<o&&(o=a));if(s){t.splice(l--,1);var c=i();void 0!==c&&(e=c)}}return e}a=a||0;for(var l=t.length;l>0&&t[l-1][2]>a;l--)t[l]=t[l-1];t[l]=[r,i,a]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={79:0};n.O.j=e=>0===t[e];var e=(e,r)=>{var i,a,[o,s,u]=r,c=0;if(o.some((e=>0!==t[e]))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(u)var l=u(n)}for(e&&e(r);c<o.length;c++)a=o[c],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(l)},r=self.webpackChunkstory_sharing_app=self.webpackChunkstory_sharing_app||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),n.nc=void 0;var i=n.O(void 0,[528,427],(()=>n(429)));i=n.O(i)})();