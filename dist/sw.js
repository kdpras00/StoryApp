importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.5.4/workbox-sw.js"),workbox?(console.log("Workbox berhasil dimuat"),workbox.precaching.precacheAndRoute([{url:"/",revision:"1"},{url:"/index.html",revision:"1"},{url:"/offline.html",revision:"1"},{url:"/manifest.json",revision:"1"},{url:"/sw.js",revision:"1"},{url:"/icons/icon-144x144.png",revision:"1"},{url:"/icons/icon-192x192.png",revision:"1"},{url:"/icons/error-icon-72x72.png",revision:"1"},{url:"/screenshots/dekstop.png",revision:"1"},{url:"/screenshots/mobile.png",revision:"1"}]),workbox.routing.registerRoute(/\.(?:js)$/,new workbox.strategies.StaleWhileRevalidate({cacheName:"js-cache"})),workbox.routing.registerRoute(/\.(?:css)$/,new workbox.strategies.StaleWhileRevalidate({cacheName:"css-cache"})),workbox.routing.registerRoute(/^https:\/\/fonts\.googleapis\.com/,new workbox.strategies.StaleWhileRevalidate({cacheName:"google-fonts-stylesheets"})),workbox.routing.registerRoute(/^https:\/\/fonts\.gstatic\.com/,new workbox.strategies.CacheFirst({cacheName:"google-fonts-webfonts",plugins:[new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200]}),new workbox.expiration.ExpirationPlugin({maxAgeSeconds:31536e3,maxEntries:30})]})),workbox.routing.registerRoute(/\.(?:png|jpg|jpeg|svg|gif|ico)$/,new workbox.strategies.CacheFirst({cacheName:"images",plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:60,maxAgeSeconds:2592e3})]})),workbox.routing.registerRoute(new RegExp("https://story-api.dicoding.dev/v1/.*"),new workbox.strategies.NetworkFirst({cacheName:"api-cache",plugins:[new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200]}),new workbox.expiration.ExpirationPlugin({maxEntries:100,maxAgeSeconds:2592e3})]})),workbox.routing.registerRoute(new RegExp("https://story-api.dicoding.dev/v1/.*"),new workbox.strategies.NetworkFirst({cacheName:"api-cache",plugins:[new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200,401]}),new workbox.expiration.ExpirationPlugin({maxEntries:100,maxAgeSeconds:2592e3})]})),workbox.routing.registerRoute(new RegExp("https://story-api.dicoding.dev/v1/stories"),(async({url:e,request:o,event:t,params:i})=>{try{const e=await fetch(o);return 401===e.status?(self.clients.matchAll().then((e=>{e.forEach((e=>{e.postMessage({type:"AUTH_ERROR",message:"Authentication failed. Please login again."})}))})),e):((await caches.open("api-cache")).put(o,e.clone()),e)}catch(e){return await caches.match(o)||new Response(JSON.stringify({error:!0,message:"You are offline. Please check your connection.",listStory:[]}),{headers:{"Content-Type":"application/json"}})}}),"GET"),workbox.routing.setDefaultHandler(new workbox.strategies.NetworkFirst({cacheName:"default-cache",plugins:[new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200]})]})),workbox.routing.setCatchHandler((async({event:e})=>"document"===e.request.destination?workbox.precaching.matchPrecache("/offline.html"):"image"===e.request.destination?workbox.precaching.matchPrecache("/icons/icon-144x144.png"):Response.error()))):console.log("Workbox gagal dimuat"),self.addEventListener("push",(e=>{let o={title:"Story App Notification",options:{body:"Ada konten cerita baru!",icon:"/icons/icon-144x144.png",badge:"/icons/error-icon-72x72.png",data:{url:self.location.origin}}};if(e.data)try{const t=e.data.json();o={title:t.title||o.title,options:{...o.options,body:t.message||o.options.body}}}catch(e){console.error("Error parsing notification payload:",e)}e.waitUntil(self.registration.showNotification(o.title,o.options))})),self.addEventListener("notificationclick",(e=>{e.notification.close();const o=e.notification.data&&e.notification.data.url?e.notification.data.url:self.location.origin;e.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then((e=>{for(let t=0;t<e.length;t++){const i=e[t];if(i.url===o&&"focus"in i)return i.focus()}if(clients.openWindow)return clients.openWindow(o)})))})),self.addEventListener("install",(e=>{self.skipWaiting()})),self.addEventListener("activate",(e=>{e.waitUntil(clients.claim())}));