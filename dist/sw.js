importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.5.4/workbox-sw.js");const CACHE_NAME="story-app-v1",urlsToCache=["/","/index.html","/offline.html","/style.css","/index.js","/model.js","/view.js","/presenter.js","/utils.js","/manifest.json","https://unpkg.com/leaflet@1.9.3/dist/leaflet.css","https://unpkg.com/leaflet@1.9.3/dist/leaflet.js","https://cdn.jsdelivr.net/npm/sweetalert2@11","https://kit.fontawesome.com/your-fontawesome-kit.js"];workbox.precaching.precacheAndRoute(urlsToCache),workbox.routing.registerRoute((({request:e})=>"navigate"===e.mode),(async({event:e})=>{try{return await workbox.strategies.NetworkFirst({cacheName:"pages-cache"}).handle({event:e})}catch(e){return caches.match("/offline.html")}})),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/sw.js").then((e=>{console.log("SW registered: ",e)})).catch((e=>{console.log("SW registration failed: ",e)}))})),workbox.routing.registerRoute((({request:e})=>"image"===e.destination),new workbox.strategies.CacheFirst({cacheName:"image-cache",plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:60,maxAgeSeconds:2592e3})]})),workbox.routing.setDefaultHandler(new workbox.strategies.NetworkFirst({cacheName:"pages-cache",plugins:[new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200]})]})),workbox.routing.registerRoute((({request:e})=>"navigate"===e.mode),(async({event:e})=>{try{return await workbox.strategies.NetworkFirst({cacheName:"pages-cache"}).handle({event:e})}catch(e){return caches.match("/offline.html")}})),self.addEventListener("push",(e=>{let t={};try{t=e.data.json()}catch(a){t={title:"Notifikasi Baru",body:e.data?e.data.text():"Ada pembaruan baru!"}}const a={body:t.body||"Ada pembaruan baru!",icon:"/icons/icon-192x192.png",badge:"/icons/icon-72x72.png",vibrate:[100,50,100],data:{url:t.url||"/"}};e.waitUntil(self.registration.showNotification(t.title||"Notifikasi Baru",a))})),self.addEventListener("notificationclick",(e=>{e.notification.close(),e.waitUntil(clients.matchAll({type:"window"}).then((t=>{const a=e.notification.data.url||"/";for(const e of t)if(e.url===a&&"focus"in e)return e.focus();if(clients.openWindow)return clients.openWindow(a)})))})),self.addEventListener("activate",(e=>{e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME)return caches.delete(e)}))))))})),self.addEventListener("install",(e=>{e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("Caching assets:",urlsToCache),e.addAll(urlsToCache).catch((e=>{console.error("Cache addAll failed:",e)}))))))}));