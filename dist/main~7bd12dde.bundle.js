/*! For license information please see main~7bd12dde.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkstory_sharing_app=self.webpackChunkstory_sharing_app||[]).push([[427],{208:(n,t,e)=>{e.d(t,{A:()=>s});var r=e(601),a=e.n(r),i=e(314),o=e.n(i)()(a());o.push([n.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap);"]),o.push([n.id,'/* Reset dan Aksesibilitas */\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nbody {\n  background-color: #1c2526; /* Hitam keabu-abuan gelap */\n  font-family: "Poppins", sans-serif;\n  line-height: 1.6;\n  color: #e0e0e0; /* Abu-abu terang untuk teks */\n  min-height: 100vh;\n  overflow-x: hidden;\n}\n\n/* Tambahkan font Poppins */\n\n.auth-section {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: calc(100vh - 100px);\n  padding: 2rem;\n  animation: fadeIn 0.5s ease-in;\n}\n\n.auth-container {\n  background: #2d3536; /* Abu-abu gelap */\n  padding: 2.5rem;\n  border-radius: 16px;\n  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);\n  width: 100%;\n  max-width: 420px;\n  margin: 0 auto;\n  transition: transform 0.3s ease;\n}\n\n.auth-container:hover {\n  transform: translateY(-4px);\n}\n\n.auth-container h2 {\n  color: #ffffff; /* Putih untuk judul */\n  font-size: 1.8rem;\n  font-weight: 600;\n  margin-bottom: 1.5rem;\n  text-align: center;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.auth-container h2 i {\n  margin-right: 0.75rem;\n  color: #a0a0a0; /* Abu-abu untuk ikon */\n}\n\n.auth-form {\n  margin-top: 1.5rem;\n}\n\n.auth-switch {\n  text-align: center;\n  margin-top: 1.5rem;\n  color: #a0a0a0; /* Abu-abu untuk teks */\n  font-size: 0.9rem;\n}\n\n.auth-switch a {\n  color: #e0e0e0; /* Abu-abu terang untuk link */\n  text-decoration: none;\n  font-weight: 500;\n  transition: color 0.3s ease;\n}\n\n.auth-switch a:hover {\n  color: #ffffff; /* Putih saat hover */\n  text-decoration: underline;\n}\n\n.page {\n  display: none;\n  animation: fadeIn 0.5s ease-in;\n}\n\n.page:not(.hidden) {\n  display: block;\n}\n\n.skip-to-content {\n  position: absolute;\n  top: -40px;\n  left: 10px;\n  background: linear-gradient(45deg, #4a4a4a, #2d3536); /* Gradasi abu-abu */\n  padding: 12px;\n  color: #ffffff;\n  text-decoration: none;\n  border-radius: 8px;\n  font-weight: 500;\n  z-index: 1001;\n}\n\n.skip-to-content:focus {\n  top: 10px;\n}\n\n/* Header */\nheader {\n  background: linear-gradient(\n    45deg,\n    #1c2526,\n    #4a4a4a\n  ); /* Gradasi hitam ke abu-abu */\n  padding: 1.2rem 2rem;\n  color: #ffffff;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 9999;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\nheader h1 {\n  font-size: 1.8rem;\n  font-weight: 600;\n  margin-right: 2rem;\n}\n\n.nav-container {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n  align-items: center;\n}\n\nnav ul {\n  list-style: none;\n  display: flex;\n  gap: 1.2rem;\n  margin: 0;\n  padding: 0;\n}\n\n.left-nav {\n  display: flex;\n}\n\n.right-nav {\n  margin-left: auto;\n}\n\nnav a {\n  color: #ffffff;\n  text-decoration: none;\n  font-weight: 500;\n  padding: 0.6rem 1.2rem;\n  border-radius: 8px;\n  transition: all 0.3s ease;\n  display: inline-block;\n}\n\nnav a:hover {\n  background-color: rgba(255, 255, 255, 0.15);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n}\n\n/* Map styling yang lebih modern */\n#map,\n#story-map {\n  width: 100%;\n  height: 400px;\n  border-radius: 16px;\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);\n  margin: 1.5rem 0;\n  overflow: hidden;\n  border: 2px solid #4a4a4a;\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\n}\n\n#map:hover,\n#story-map:hover {\n  transform: translateY(-4px);\n  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.5);\n}\n\n/* Mobile Friendly */\n@media (max-width: 768px) {\n  header {\n    padding: 1rem;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  header h1 {\n    margin-right: 0;\n    margin-bottom: 0.8rem;\n  }\n\n  .nav-container {\n    flex-direction: column;\n    width: 100%;\n  }\n\n  nav ul {\n    width: 100%;\n    justify-content: center;\n    margin-top: 0.8rem;\n  }\n\n  .left-nav,\n  .right-nav {\n    justify-content: center;\n    width: 100%;\n  }\n\n  .right-nav {\n    margin-top: 0.8rem;\n  }\n\n  .leaflet-control-zoom,\n  .leaflet-control-layers {\n    position: fixed !important;\n    z-index: 1000 !important;\n  }\n\n  .leaflet-control-zoom {\n    bottom: 80px !important;\n    right: 10px !important;\n  }\n\n  .leaflet-control-layers {\n    bottom: 150px !important;\n    right: 10px !important;\n  }\n}\n\n@media (max-width: 480px) {\n  nav a {\n    padding: 0.5rem 0.8rem;\n    font-size: 0.9rem;\n  }\n\n  header h1 {\n    font-size: 1.3rem;\n  }\n}\n\n.hidden {\n  display: none;\n}\n\n/* Main */\nmain {\n  padding: 160px 2rem 2rem;\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n/* Story List */\n#story-list {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));\n  gap: 1.5rem;\n  margin-top: 2rem;\n}\n\n.story-card {\n  background: #2d3536; /* Abu-abu gelap */\n  padding: 1.5rem;\n  border-radius: 12px;\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\n}\n\n.story-card:hover {\n  transform: translateY(-6px);\n  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4);\n}\n\n.story-card img {\n  max-width: 100%;\n  height: auto;\n  border-radius: 8px;\n  margin-bottom: 1rem;\n}\n\n.story-card h3 {\n  color: #ffffff; /* Putih untuk judul */\n  font-size: 1.25rem;\n  font-weight: 600;\n  margin: 0.5rem 0;\n}\n\n.story-card p {\n  color: #a0a0a0; /* Abu-abu untuk teks */\n  font-size: 0.95rem;\n  margin: 0.5rem 0;\n}\n\n/* Form */\n.form-group {\n  margin-bottom: 1.75rem;\n  position: relative;\n}\n\n.form-group label {\n  display: flex;\n  align-items: center;\n  margin-bottom: 0.5rem;\n  font-weight: 500;\n  color: #e0e0e0; /* Abu-abu terang untuk label */\n}\n\n.form-group label i {\n  margin-right: 0.5rem;\n  color: #a0a0a0; /* Abu-abu untuk ikon */\n}\n\n.form-group input,\n.form-group textarea {\n  width: 100%;\n  padding: 0.85rem 1.2rem;\n  border: 2px solid #4a4a4a; /* Abu-abu untuk border */\n  border-radius: 10px;\n  font-size: 1rem;\n  background: #1c2526; /* Hitam keabu-abuan untuk background */\n  color: #e0e0e0; /* Abu-abu terang untuk teks */\n  transition: all 0.3s ease;\n}\n\n.form-group input:focus,\n.form-group textarea:focus {\n  border-color: #a0a0a0; /* Abu-abu saat fokus */\n  box-shadow: 0 0 0 4px rgba(160, 160, 160, 0.1);\n  outline: none;\n  background: #2d3536; /* Abu-abu gelap saat fokus */\n}\n\n.form-group input::placeholder,\n.form-group textarea::placeholder {\n  color: #a0a0a0; /* Abu-abu untuk placeholder */\n}\n\n.form-group textarea {\n  height: 140px;\n  resize: vertical;\n}\n\n.image-input-container {\n  display: flex;\n  gap: 1.5rem;\n  flex-wrap: wrap;\n}\n\n.camera-container,\n.file-upload-container {\n  flex: 1;\n  min-width: 320px;\n  position: relative;\n}\n\n#camera,\n#canvas,\n#preview {\n  max-width: 100%;\n  border-radius: 10px;\n  margin-bottom: 1rem;\n  border: 2px solid #4a4a4a;\n}\n\n#capture,\n#close-camera {\n  margin-right: 0.5rem;\n}\n\n#close-camera {\n  background: linear-gradient(45deg, #e74c3c, #c0392b);\n}\n\n#close-camera:hover {\n  background: linear-gradient(45deg, #c0392b, #e74c3c);\n}\n\n.form-group video,\n.form-group canvas,\n.form-group #preview {\n  max-width: 100%;\n  border: 2px solid #4a4a4a; /* Abu-abu untuk border */\n  border-radius: 10px;\n  margin-bottom: 1rem;\n}\n\n.file-input {\n  width: 0.1px;\n  height: 0.1px;\n  opacity: 0;\n  overflow: hidden;\n  position: absolute;\n  z-index: -1;\n}\n\n.file-label {\n  display: inline-flex;\n  align-items: center;\n  padding: 0.85rem 1.75rem;\n  background: linear-gradient(45deg, #4a4a4a, #2d3536); /* Gradasi abu-abu */\n  color: #ffffff;\n  border-radius: 10px;\n  cursor: pointer;\n  font-weight: 500;\n  text-align: center;\n  transition: all 0.3s ease;\n}\n\n.file-label:hover {\n  background: linear-gradient(45deg, #2d3536, #4a4a4a);\n  transform: translateY(-2px);\n  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);\n}\n\n.file-label i {\n  margin-right: 0.5rem;\n}\n\n.password-input {\n  position: relative;\n}\n\n.toggle-password {\n  position: absolute;\n  bottom: 10%;\n  right: 1.2rem;\n  transform: translateY(-50%);\n  font-size: 1.2rem;\n  color: #a0a0a0;\n  cursor: pointer;\n  transition: color 0.3s ease;\n}\n\n.toggle-password:hover {\n  color: #ffffff;\n}\n\nbutton {\n  background: linear-gradient(45deg, #4a4a4a, #2d3536); /* Gradasi abu-abu */\n  color: #ffffff;\n  padding: 0.85rem 1.75rem;\n  border: none;\n  border-radius: 10px;\n  cursor: pointer;\n  font-weight: 500;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s ease;\n}\n\nbutton i {\n  margin-right: 0.5rem;\n}\n\nbutton:hover {\n  background: linear-gradient(45deg, #2d3536, #4a4a4a);\n  transform: translateY(-2px);\n  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);\n}\n\nbutton:active {\n  transform: translateY(0);\n}\n\n.btn-primary {\n  width: 100%;\n  margin-top: 1.5rem;\n}\n\n/* Map */\n#map {\n  width: 100%;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  margin: 1.5rem 0;\n  overflow: hidden;\n}\n\n.leaflet-control-zoom {\n  border: none !important;\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3) !important;\n}\n\n.leaflet-control-zoom a {\n  background: #2d3536 !important; /* Abu-abu gelap */\n  color: #ffffff !important;\n  border: 1px solid #4a4a4a !important; /* Abu-abu untuk border */\n  transition: all 0.3s ease !important;\n}\n\n.leaflet-control-zoom a:hover {\n  background: #4a4a4a !important; /* Abu-abu lebih terang saat hover */\n  color: #ffffff !important;\n}\n\n.leaflet-popup-content-wrapper {\n  border-radius: 10px !important;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;\n}\n\n.leaflet-popup-content {\n  margin: 0.75rem 1.25rem !important;\n  font-family: "Poppins", sans-serif !important;\n  color: #e0e0e0 !important; /* Abu-abu terang untuk teks */\n}\n\n/* Animasi */\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n/* Tambahkan animasi fadeOut */\n@keyframes fadeOut {\n  from {\n    opacity: 1;\n    transform: translateY(0);\n  }\n  to {\n    opacity: 0;\n    transform: translateY(-20px);\n  }\n}\n\n/* Mobile Friendly */\n/* Perbaikan untuk kontrol peta pada tampilan mobile */\n@media (max-width: 768px) {\n  .leaflet-control-zoom,\n  .leaflet-control-layers {\n    position: fixed !important;\n    z-index: 1000 !important;\n  }\n\n  .leaflet-control-zoom {\n    bottom: 80px !important;\n    right: 10px !important;\n  }\n\n  .leaflet-control-layers {\n    bottom: 150px !important;\n    right: 10px !important;\n  }\n\n  #map,\n  #story-map {\n    height: 300px !important;\n  }\n\n  .image-input-container {\n    flex-direction: column;\n  }\n\n  .camera-container,\n  .file-upload-container {\n    width: 100%;\n  }\n\n  /* Memperbaiki padding untuk form pada mobile */\n  .form-group input,\n  .form-group textarea {\n    padding: 0.7rem 1rem;\n  }\n\n  /* Memperbaiki ukuran font untuk mobile */\n  body {\n    font-size: 14px;\n  }\n\n  /* Memperbaiki header pada mobile */\n  header {\n    padding: 1rem;\n  }\n\n  /* Memperbaiki navigasi pada mobile */\n  nav ul {\n    gap: 0.5rem;\n  }\n\n  nav a {\n    padding: 0.5rem 0.8rem;\n    font-size: 0.9rem;\n  }\n}\n\n/* Tambahan untuk perangkat sangat kecil */\n@media (max-width: 480px) {\n  header h1 {\n    font-size: 1.3rem;\n  }\n\n  .auth-container {\n    padding: 1.5rem;\n  }\n\n  .auth-container h2 {\n    font-size: 1.3rem;\n  }\n\n  .form-group label {\n    font-size: 0.9rem;\n  }\n\n  .form-group input,\n  .form-group textarea {\n    font-size: 0.9rem;\n    padding: 0.6rem 0.8rem;\n  }\n\n  button,\n  .file-label {\n    padding: 0.6rem 1rem;\n    font-size: 0.9rem;\n  }\n\n  #map,\n  #story-map {\n    height: 250px !important;\n  }\n}\n\n.favorite-btn {\n  margin-top: 1rem;\n  background: linear-gradient(45deg, #4a4a4a, #2d3536);\n  border: none;\n  border-radius: 8px;\n  padding: 0.6rem 1rem;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n}\n\n.favorite-btn:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\n}\n\n.favorite-btn.favorited {\n  background: linear-gradient(45deg, #e74c3c, #c0392b);\n}\n\n.favorite-btn i {\n  font-size: 1.1rem;\n}\n',""]);const s=o},511:(n,t,e)=>{var r=e(72),a=e.n(r),i=e(825),o=e.n(i),s=e(659),u=e.n(s),c=e(56),h=e.n(c),l=e(540),p=e.n(l),f=e(113),d=e.n(f),g=e(208),m={};m.styleTagTransform=d(),m.setAttributes=h(),m.insert=u().bind(null,"head"),m.domAPI=o(),m.insertStyleElement=p(),a()(g.A,m),g.A&&g.A.locals&&g.A.locals},618:(n,t,e)=>{function r(n){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r(n)}function a(){a=function(){return t};var n,t={},e=Object.prototype,i=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function h(n,t,e,r){return Object.defineProperty(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r})}try{h({},"")}catch(n){h=function(n,t,e){return n[t]=e}}function l(t,e,r,a){var i=e&&e.prototype instanceof d?e:d,o=Object.create(i.prototype);return h(o,"_invoke",function(t,e,r){var a=1;return function(i,o){if(3===a)throw Error("Generator is already running");if(4===a){if("throw"===i)throw o;return{value:n,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===a)throw a=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=3;var c=p(t,e,r);if("normal"===c.type){if(a=r.done?4:2,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=4,r.method="throw",r.arg=c.arg)}}}(t,r,new M(a||[])),!0),o}function p(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=l;var f={};function d(){}function g(){}function m(){}var v={};h(v,s,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(j([])));w&&w!==e&&i.call(w,s)&&(v=w);var y=m.prototype=d.prototype=Object.create(v);function x(n){["next","throw","return"].forEach((function(t){h(n,t,(function(n){return this._invoke(t,n)}))}))}function k(n,t){function e(a,o,s,u){var c=p(n[a],n,o);if("throw"!==c.type){var h=c.arg,l=h.value;return l&&"object"==r(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(n){e("next",n,s,u)}),(function(n){e("throw",n,s,u)})):t.resolve(l).then((function(n){h.value=n,s(h)}),(function(n){return e("throw",n,s,u)}))}u(c.arg)}var a;h(this,"_invoke",(function(n,r){function i(){return new t((function(t,a){e(n,r,t,a)}))}return a=a?a.then(i,i):i()}),!0)}function S(t,e){var r=e.method,a=t.i[r];if(a===n)return e.delegate=null,"throw"===r&&t.i.return&&(e.method="return",e.arg=n,S(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=p(a,t.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var o=i.arg;return o?o.done?(e[t.r]=o.value,e.next=t.n,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function P(n){this.tryEntries.push(n)}function E(t){var e=t[4]||{};e.type="normal",e.arg=n,t[4]=e}function M(n){this.tryEntries=[[-1]],n.forEach(P,this),this.reset(!0)}function j(t){if(null!=t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function e(){for(;++a<t.length;)if(i.call(t,a))return e.value=t[a],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}throw new TypeError(r(t)+" is not iterable")}return g.prototype=m,h(y,"constructor",m),h(m,"constructor",g),g.displayName=h(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,m):(n.__proto__=m,h(n,c,"GeneratorFunction")),n.prototype=Object.create(y),n},t.awrap=function(n){return{__await:n}},x(k.prototype),h(k.prototype,u,(function(){return this})),t.AsyncIterator=k,t.async=function(n,e,r,a,i){void 0===i&&(i=Promise);var o=new k(l(n,e,r,a),i);return t.isGeneratorFunction(e)?o:o.next().then((function(n){return n.done?n.value:o.next()}))},x(y),h(y,c,"Generator"),h(y,s,(function(){return this})),h(y,"toString",(function(){return"[object Generator]"})),t.keys=function(n){var t=Object(n),e=[];for(var r in t)e.unshift(r);return function n(){for(;e.length;)if((r=e.pop())in t)return n.value=r,n.done=!1,n;return n.done=!0,n}},t.values=j,M.prototype={constructor:M,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var n=this.tryEntries[0][4];if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n){o.type="throw",o.arg=t,e.next=n}for(var a=e.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return r("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=n,r(u),!0;if(s<c)return r(c),!1}}},abrupt:function(n,t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var a=r;break}}a&&("break"===n||"continue"===n)&&a[0]<=t&&t<=a[2]&&(a=null);var i=a?a[4]:{};return i.type=n,i.arg=t,a?(this.method="next",this.next=a[2],f):this.complete(i)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),f},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e[2]===n)return this.complete(e[4],e[3]),E(e),f}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e[0]===n){var r=e[4];if("throw"===r.type){var a=r.arg;E(e)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={i:j(t),r:e,n:r},"next"===this.method&&(this.arg=n),f}},t}function i(n,t,e,r,a,i,o){try{var s=n[i](o),u=s.value}catch(n){return void e(n)}s.done?t(u):Promise.resolve(u).then(r,a)}function o(n){return function(){var t=this,e=arguments;return new Promise((function(r,a){var o=n.apply(t,e);function s(n){i(o,r,a,s,u,"next",n)}function u(n){i(o,r,a,s,u,"throw",n)}s(void 0)}))}}e.d(t,{OD:()=>g,Vt:()=>h,_J:()=>p,iK:()=>d,jj:()=>m,no:()=>l,wy:()=>f});var s="stories",u="favorites",c=function(){return new Promise((function(n,t){var e=indexedDB.open("story-app-db",1);e.onerror=function(n){t("Error opening database: "+n.target.error)},e.onsuccess=function(t){n(t.target.result)},e.onupgradeneeded=function(n){var t=n.target.result;t.objectStoreNames.contains(s)||t.createObjectStore(s,{keyPath:"id"}),t.objectStoreNames.contains(u)||t.createObjectStore(u,{keyPath:"id"})}}))},h=function(){var n=o(a().mark((function n(t){var e,r,i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c();case 3:return e=n.sent,r=e.transaction(s,"readwrite"),i=r.objectStore(s),n.next=8,i.clear();case 8:return t.forEach((function(n){i.add(n)})),n.abrupt("return",new Promise((function(n,t){r.oncomplete=function(){return n(!0)},r.onerror=function(n){return t(n.target.error)}})));case 12:return n.prev=12,n.t0=n.catch(0),console.error("Error saving stories to IndexedDB:",n.t0),n.abrupt("return",!1);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(t){return n.apply(this,arguments)}}(),l=function(){var n=o(a().mark((function n(){var t,e,r,i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c();case 3:return t=n.sent,e=t.transaction(s,"readonly"),r=e.objectStore(s),i=r.getAll(),n.abrupt("return",new Promise((function(n,t){i.onsuccess=function(){return n(i.result)},i.onerror=function(n){return t(n.target.error)}})));case 10:return n.prev=10,n.t0=n.catch(0),console.error("Error getting stories from IndexedDB:",n.t0),n.abrupt("return",[]);case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}}(),p=function(){var n=o(a().mark((function n(t){var e,r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c();case 3:return e=n.sent,(r=e.transaction(u,"readwrite")).objectStore(u).add(t),n.abrupt("return",new Promise((function(n,t){r.oncomplete=function(){return n(!0)},r.onerror=function(n){return t(n.target.error)}})));case 10:return n.prev=10,n.t0=n.catch(0),console.error("Error adding to favorites:",n.t0),n.abrupt("return",!1);case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(t){return n.apply(this,arguments)}}(),f=function(){var n=o(a().mark((function n(t){var e,r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c();case 3:return e=n.sent,(r=e.transaction(u,"readwrite")).objectStore(u).delete(t),n.abrupt("return",new Promise((function(n,t){r.oncomplete=function(){return n(!0)},r.onerror=function(n){return t(n.target.error)}})));case 10:return n.prev=10,n.t0=n.catch(0),console.error("Error removing from favorites:",n.t0),n.abrupt("return",!1);case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(t){return n.apply(this,arguments)}}(),d=function(){var n=o(a().mark((function n(){var t,e,r,i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c();case 3:return t=n.sent,e=t.transaction(u,"readonly"),r=e.objectStore(u),i=r.getAll(),n.abrupt("return",new Promise((function(n,t){i.onsuccess=function(){return n(i.result)},i.onerror=function(n){return t(n.target.error)}})));case 10:return n.prev=10,n.t0=n.catch(0),console.error("Error getting favorite stories:",n.t0),n.abrupt("return",[]);case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}}(),g=function(){var n=o(a().mark((function n(t){var e,r,i,o;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c();case 3:return e=n.sent,r=e.transaction(u,"readonly"),i=r.objectStore(u),o=i.get(t),n.abrupt("return",new Promise((function(n,t){o.onsuccess=function(){return n(!!o.result)},o.onerror=function(n){return t(n.target.error)}})));case 10:return n.prev=10,n.t0=n.catch(0),console.error("Error checking if story is in favorites:",n.t0),n.abrupt("return",!1);case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(t){return n.apply(this,arguments)}}(),m=function(n){for(var t=(n+"=".repeat((4-n.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),e=window.atob(t),r=new Uint8Array(e.length),a=0;a<e.length;++a)r[a]=e.charCodeAt(a);return r}},667:(n,t,e)=>{e.d(t,{A:()=>h});var r=e(618);function a(n){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},a(n)}function i(){i=function(){return t};var n,t={},e=Object.prototype,r=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function h(n,t,e,r){return Object.defineProperty(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r})}try{h({},"")}catch(n){h=function(n,t,e){return n[t]=e}}function l(t,e,r,a){var i=e&&e.prototype instanceof d?e:d,o=Object.create(i.prototype);return h(o,"_invoke",function(t,e,r){var a=1;return function(i,o){if(3===a)throw Error("Generator is already running");if(4===a){if("throw"===i)throw o;return{value:n,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var u=S(s,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===a)throw a=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=3;var c=p(t,e,r);if("normal"===c.type){if(a=r.done?4:2,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=4,r.method="throw",r.arg=c.arg)}}}(t,r,new M(a||[])),!0),o}function p(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=l;var f={};function d(){}function g(){}function m(){}var v={};h(v,s,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(j([])));w&&w!==e&&r.call(w,s)&&(v=w);var y=m.prototype=d.prototype=Object.create(v);function x(n){["next","throw","return"].forEach((function(t){h(n,t,(function(n){return this._invoke(t,n)}))}))}function k(n,t){function e(i,o,s,u){var c=p(n[i],n,o);if("throw"!==c.type){var h=c.arg,l=h.value;return l&&"object"==a(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(n){e("next",n,s,u)}),(function(n){e("throw",n,s,u)})):t.resolve(l).then((function(n){h.value=n,s(h)}),(function(n){return e("throw",n,s,u)}))}u(c.arg)}var i;h(this,"_invoke",(function(n,r){function a(){return new t((function(t,a){e(n,r,t,a)}))}return i=i?i.then(a,a):a()}),!0)}function S(t,e){var r=e.method,a=t.i[r];if(a===n)return e.delegate=null,"throw"===r&&t.i.return&&(e.method="return",e.arg=n,S(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=p(a,t.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var o=i.arg;return o?o.done?(e[t.r]=o.value,e.next=t.n,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function P(n){this.tryEntries.push(n)}function E(t){var e=t[4]||{};e.type="normal",e.arg=n,t[4]=e}function M(n){this.tryEntries=[[-1]],n.forEach(P,this),this.reset(!0)}function j(t){if(null!=t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function e(){for(;++i<t.length;)if(r.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}throw new TypeError(a(t)+" is not iterable")}return g.prototype=m,h(y,"constructor",m),h(m,"constructor",g),g.displayName=h(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,m):(n.__proto__=m,h(n,c,"GeneratorFunction")),n.prototype=Object.create(y),n},t.awrap=function(n){return{__await:n}},x(k.prototype),h(k.prototype,u,(function(){return this})),t.AsyncIterator=k,t.async=function(n,e,r,a,i){void 0===i&&(i=Promise);var o=new k(l(n,e,r,a),i);return t.isGeneratorFunction(e)?o:o.next().then((function(n){return n.done?n.value:o.next()}))},x(y),h(y,c,"Generator"),h(y,s,(function(){return this})),h(y,"toString",(function(){return"[object Generator]"})),t.keys=function(n){var t=Object(n),e=[];for(var r in t)e.unshift(r);return function n(){for(;e.length;)if((r=e.pop())in t)return n.value=r,n.done=!1,n;return n.done=!0,n}},t.values=j,M.prototype={constructor:M,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var n=this.tryEntries[0][4];if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n){o.type="throw",o.arg=t,e.next=n}for(var a=e.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return r("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=n,r(u),!0;if(s<c)return r(c),!1}}},abrupt:function(n,t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var a=r;break}}a&&("break"===n||"continue"===n)&&a[0]<=t&&t<=a[2]&&(a=null);var i=a?a[4]:{};return i.type=n,i.arg=t,a?(this.method="next",this.next=a[2],f):this.complete(i)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),f},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e[2]===n)return this.complete(e[4],e[3]),E(e),f}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e[0]===n){var r=e[4];if("throw"===r.type){var a=r.arg;E(e)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={i:j(t),r:e,n:r},"next"===this.method&&(this.arg=n),f}},t}function o(n,t,e,r,a,i,o){try{var s=n[i](o),u=s.value}catch(n){return void e(n)}s.done?t(u):Promise.resolve(u).then(r,a)}function s(n){return function(){var t=this,e=arguments;return new Promise((function(r,a){var i=n.apply(t,e);function s(n){o(i,r,a,s,u,"next",n)}function u(n){o(i,r,a,s,u,"throw",n)}s(void 0)}))}}function u(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,c(r.key),r)}}function c(n){var t=function(n){if("object"!=a(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=a(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==a(t)?t:t+""}const h=function(){return n=function n(t,e){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.model=t,this.view=e,this.location={lat:null,lng:null},this.map=null,this._currentHash=null,this.view.onFavoriteClick=this.handleFavoriteClick.bind(this),this.view.onRegisterSubmit=this.handleRegisterSubmit.bind(this),this.view.onLoginSubmit=this.handleLoginSubmit.bind(this),this.view.onStorySubmit=this.handleStorySubmit.bind(this),this.view.onCaptureClick=this.handleCaptureClick.bind(this),this.view.onNavLinkClick=this.handleNavLinkClick.bind(this),this.view.onMapClick=this.handleMapClick.bind(this),this.init()},t=[{key:"init",value:(v=s(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.setupPushNotification();case 2:if(this.view.updateNav(this.model.isLoggedIn()),this.setupRouting(),!this.model.isLoggedIn()){n.next=9;break}return n.next=7,this.loadStories();case 7:n.next=10;break;case 9:this.view.navigateTo("login");case 10:window.addEventListener("hashchange",this.handleRouteChange.bind(this)),this.handleRouteChange();case 12:case"end":return n.stop()}}),n,this)}))),function(){return v.apply(this,arguments)})},{key:"handleMapClick",value:function(n){this.location={lat:n.lat,lng:n.lng},this.view.updateMapMarker(n)}},{key:"handleCaptureClick",value:function(){var n=this.view.captureImage();n?this.view.showImagePreview(n):this.view.showMessage("Gagal mengambil gambar dari kamera.",!0)}},{key:"handleRegisterSubmit",value:(m=s(i().mark((function n(t){var e;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.model.register(t);case 3:e=n.sent,this.view.showMessage(e.message,e.error),e.error||this.view.navigateTo("login"),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),this.view.showMessage("Gagal mendaftar: "+n.t0.message,!0);case 11:case"end":return n.stop()}}),n,this,[[0,8]])}))),function(n){return m.apply(this,arguments)})},{key:"handleLoginSubmit",value:(g=s(i().mark((function n(t){var e,r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.model.login(t);case 3:if(e=n.sent,this.view.showMessage(e.message,e.error),e.error){n.next=17;break}return this.view.updateNav(!0),this.view.navigateTo("home"),n.next=10,this.loadStories();case 10:if("granted"!==Notification.permission){n.next=17;break}return n.next=13,navigator.serviceWorker.getRegistration();case 13:if(!(r=n.sent)){n.next=17;break}return n.next=17,this.subscribeToPush(r);case 17:n.next=22;break;case 19:n.prev=19,n.t0=n.catch(0),this.view.showMessage("Gagal login: "+n.t0.message,!0);case 22:case"end":return n.stop()}}),n,this,[[0,19]])}))),function(n){return g.apply(this,arguments)})},{key:"handleStorySubmit",value:(d=s(i().mark((function n(t){var e,r,a,o,s,u;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.model.isLoggedIn()){n.next=4;break}return this.view.showMessage("Silakan login terlebih dahulu",!0),this.view.navigateTo("login"),n.abrupt("return");case 4:if(e=t.description,r=t.photoFile,a=t.imageData,e){n.next=8;break}return this.view.showMessage("Deskripsi tidak boleh kosong.",!0),n.abrupt("return");case 8:if(this.location.lat&&this.location.lng){n.next=11;break}return this.view.showMessage("Harap pilih lokasi di peta.",!0),n.abrupt("return");case 11:if(o=new FormData,!r){n.next=19;break}if(!(r.size>1048576)){n.next=16;break}return this.view.showMessage("Ukuran foto terlalu besar. Maksimal 1MB.",!0),n.abrupt("return");case 16:s=r,n.next=39;break;case 19:if(!a){n.next=37;break}return n.prev=20,n.next=23,fetch(a);case 23:return n.next=25,n.sent.blob();case 25:if(!((s=n.sent).size>1048576)){n.next=29;break}return this.view.showMessage("Ukuran foto terlalu besar. Maksimal 1MB.",!0),n.abrupt("return");case 29:n.next=35;break;case 31:return n.prev=31,n.t0=n.catch(20),this.view.showMessage("Gagal memproses gambar dari kamera.",!0),n.abrupt("return");case 35:n.next=39;break;case 37:return this.view.showMessage("Harap pilih foto atau ambil gambar.",!0),n.abrupt("return");case 39:return o.append("description",e),o.append("photo",s,"story.jpg"),o.append("lat",this.location.lat),o.append("lon",this.location.lng),n.prev=43,n.next=46,this.model.addStory(o);case 46:if(u=n.sent,this.view.showMessage(u.message,u.error),u.error){n.next=53;break}return this.cleanupAfterStorySubmit(),n.next=52,this.loadStories();case 52:this.view.navigateTo("home");case 53:n.next=58;break;case 55:n.prev=55,n.t1=n.catch(43),this.view.showMessage("Gagal menambahkan cerita: "+n.t1.message,!0);case 58:case"end":return n.stop()}}),n,this,[[20,31],[43,55]])}))),function(n){return d.apply(this,arguments)})},{key:"cleanupAfterStorySubmit",value:function(){this.view.stopCamera(),this.view.resetStoryForm(),this.location={lat:null,lng:null},this.view.clearMapMarkers()}},{key:"handleNavLinkClick",value:function(n,t){this.model.isLoggedIn()||"home"!==t&&"add-story"!==t&&"favorites"!==t?"logout"===t&&(n.preventDefault(),this.handleLogout()):(n.preventDefault(),this.view.showMessage("Silakan login terlebih dahulu",!0),this.view.navigateTo("login"))}},{key:"handleLogout",value:function(){this.model.logout(),this.view.updateNav(!1),this.view.stopCamera(),this.view.showMessage("Berhasil logout",!1),this.view.navigateTo("login")}},{key:"handleRouteChange",value:function(){var n=this,t=this.view.getCurrentHash(),e=this._currentHash;this._currentHash=t,this.model.isLoggedIn()||"home"!==t&&"add-story"!==t&&"favorites"!==t?["home","add-story","login","register","favorites"].includes(t)?("add-story"===e&&"add-story"!==t&&this.view.stopCamera(),this.view.handlePageViewTransition(t,s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.handlePageSpecificSetup(t);case 2:case"end":return e.stop()}}),e)}))))):this.showNotFoundPage():this.view.navigateTo("login")}},{key:"showNotFoundPage",value:function(){document.getElementById("not-found")?this.view.showPage("not-found"):this.model.isLoggedIn()?this.view.navigateTo("home"):this.view.navigateTo("login"),this.view.showMessage("Halaman tidak ditemukan",!0)}},{key:"handlePageSpecificSetup",value:(f=s(i().mark((function n(t){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t,n.next="home"===n.t0?3:"add-story"===n.t0?7:"favorites"===n.t0?10:13;break;case 3:return n.next=5,this.loadStories();case 5:return this.view.storyMap||this.view.setupStoryMap(),n.abrupt("break",15);case 7:return n.next=9,this.setupAddStoryPage();case 9:case 12:return n.abrupt("break",15);case 10:return n.next=12,this.loadFavoriteStories();case 13:return this.view.stopCamera(),n.abrupt("break",15);case 15:case"end":return n.stop()}}),n,this)}))),function(n){return f.apply(this,arguments)})},{key:"setupAddStoryPage",value:(p=s(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.view.setupCamera();case 3:this.map||(this.map=this.view.setupMap()),this.location={lat:null,lng:null},this.view.clearMapMarkers(),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),this.view.showMessage("Kamera tidak tersedia",!0);case 11:case"end":return n.stop()}}),n,this,[[0,8]])}))),function(){return p.apply(this,arguments)})},{key:"loadStories",value:(l=s(i().mark((function n(){var t,e;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.model.isLoggedIn()){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,n.next=5,this.model.fetchStories();case 5:return t=n.sent,n.next=8,this.model.getFavorites();case 8:e=n.sent,this.view.displayStories(t,e),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(2),this.view.showMessage("Gagal memuat cerita: "+n.t0.message,!0);case 15:case"end":return n.stop()}}),n,this,[[2,12]])}))),function(){return l.apply(this,arguments)})},{key:"loadFavoriteStories",value:(h=s(i().mark((function n(){var t;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.model.isLoggedIn()){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,n.next=5,this.model.getFavorites();case 5:t=n.sent,this.view.displayFavoriteStories(t),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),this.view.showMessage("Gagal memuat cerita favorit: "+n.t0.message,!0);case 12:case"end":return n.stop()}}),n,this,[[2,9]])}))),function(){return h.apply(this,arguments)})},{key:"setupPushNotification",value:(c=s(i().mark((function n(){var t,e,r=this;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("serviceWorker"in navigator&&"PushManager"in window){n.next=3;break}return console.log("Push notifications not supported in this browser"),n.abrupt("return");case 3:return n.prev=3,n.next=6,navigator.serviceWorker.register("/sw.js");case 6:t=n.sent,e=Notification.permission,n.t0=e,n.next="granted"===n.t0?11:"denied"===n.t0?15:(n.t0,18);break;case 11:return n.next=13,this.subscribeToPush(t);case 13:return this.view.updateNotificationUI(!0),n.abrupt("break",21);case 15:return console.log("Push notification permission was denied"),this.view.updateNotificationUI(!1),n.abrupt("break",21);case 18:return this.view.setupNotificationButton((function(){return r.requestNotificationPermission(t)})),this.view.updateNotificationUI(!1),n.abrupt("break",21);case 21:n.next=26;break;case 23:n.prev=23,n.t1=n.catch(3),console.error("Service worker registration failed:",n.t1);case 26:case"end":return n.stop()}}),n,this,[[3,23]])}))),function(){return c.apply(this,arguments)})},{key:"requestNotificationPermission",value:(o=s(i().mark((function n(t){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Notification.requestPermission();case 3:if("granted"!==n.sent){n.next=11;break}return n.next=7,this.subscribeToPush(t);case 7:this.view.showMessage("Notifikasi berhasil diaktifkan!",!1),this.view.updateNotificationUI(!0),n.next=13;break;case 11:this.view.showMessage("Notifikasi tidak diaktifkan",!1),this.view.updateNotificationUI(!1);case 13:n.next=20;break;case 15:n.prev=15,n.t0=n.catch(0),console.error("Permission request failed:",n.t0),this.view.showMessage("Gagal meminta izin notifikasi",!0),this.view.updateNotificationUI(!1);case 20:case"end":return n.stop()}}),n,this,[[0,15]])}))),function(n){return o.apply(this,arguments)})},{key:"subscribeToPush",value:(a=s(i().mark((function n(t){var e;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(0,r.jj)("BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk")});case 3:if(e=n.sent,!this.model.isLoggedIn()){n.next=8;break}return n.next=7,this.model.subscribePush(e);case 7:console.log("Push notification subscription successful");case 8:n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),console.error("Push subscription failed:",n.t0),this.view.updateNotificationUI(!1);case 14:case"end":return n.stop()}}),n,this,[[0,10]])}))),function(n){return a.apply(this,arguments)})},{key:"handleFavoriteClick",value:(e=s(i().mark((function n(t,e){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.model.isLoggedIn()){n.next=4;break}return this.view.showMessage("Silakan login terlebih dahulu",!0),this.view.navigateTo("login"),n.abrupt("return");case 4:if(n.prev=4,!e){n.next=11;break}return n.next=8,this.model.addStoryToFavorites(t);case 8:this.view.showMessage("Cerita ditambahkan ke favorit",!1),n.next=14;break;case 11:return n.next=13,this.model.removeStoryFromFavorites(t.id);case 13:this.view.showMessage("Cerita dihapus dari favorit",!1);case 14:if(this.view.updateFavoriteButton(t.id,e),"favorites"!==this.view.getCurrentHash()){n.next=21;break}return n.next=19,this.loadFavoriteStories();case 19:n.next=23;break;case 21:return n.next=23,this.loadStories();case 23:n.next=28;break;case 25:n.prev=25,n.t0=n.catch(4),this.view.showMessage("Gagal memperbarui favorit: "+n.t0.message,!0);case 28:case"end":return n.stop()}}),n,this,[[4,25]])}))),function(n,t){return e.apply(this,arguments)})},{key:"setupRouting",value:function(){this.handleRouteChange()}}],t&&u(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,a,o,c,h,l,p,f,d,g,m,v}()}}]);